- We can use **adPEAS** to further enumerate the domain, since it integrates **SharpHound** and **PowerView**(the new version).
```powershell
PS C:\Auditor> ipmo .\adPEAS.ps1
PS C:\Auditor> Invoke-adPEAS
```
#### Current Forest
- The first thing we have to do is find some information about the forest and the domain we are currently at.
```powershell
PS C:\Auditor> Get-Forest


RootDomainSid         : S-1-5-21-2781415573-3701854478-2406986946
Name                  : techcorp.local
Sites                 : {Default-First-Site-Name}
Domains               : {techcorp.local, us.techcorp.local}
GlobalCatalogs        : {Techcorp-DC.techcorp.local, US-DC.us.techcorp.local}
ApplicationPartitions : {DC=DomainDnsZones,DC=techcorp,DC=local, DC=DomainDnsZones,DC=us,DC=techcorp,DC=local,
                        DC=ForestDnsZones,DC=techcorp,DC=local}
ForestModeLevel       : 7
ForestMode            : Unknown
RootDomain            : techcorp.local
Schema                : CN=Schema,CN=Configuration,DC=techcorp,DC=local
SchemaRoleOwner       : Techcorp-DC.techcorp.local
NamingRoleOwner       : Techcorp-DC.techcorp.local
```
#### Forest Trusts
```powershell
PS C:\Auditor> Get-ForestTrust


TopLevelNames            : {usvendor.local}
ExcludedTopLevelNames    : {}
TrustedDomainInformation : {usvendor.local}
SourceName               : techcorp.local
TargetName               : usvendor.local
TrustType                : Forest
TrustDirection           : Bidirectional

TopLevelNames            : {bastion.local}
ExcludedTopLevelNames    : {}
TrustedDomainInformation : {bastion.local}
SourceName               : techcorp.local
TargetName               : bastion.local
TrustType                : Forest
TrustDirection           : Inbound
```
#### Current Domain
```powershell
PS C:\Auditor> Get-Domain


Forest                  : techcorp.local
DomainControllers       : {US-DC.us.techcorp.local}
Children                : {}
DomainMode              : Unknown
DomainModeLevel         : 7
Parent                  : techcorp.local
PdcRoleOwner            : US-DC.us.techcorp.local
RidRoleOwner            : US-DC.us.techcorp.local
InfrastructureRoleOwner : US-DC.us.techcorp.local
Name                    : us.techcorp.local
```
#### Domain Trusts
```powershell
PS C:\Auditor> Get-DomainTrust


SourceName      : us.techcorp.local
TargetName      : techcorp.local
TrustType       : WINDOWS_ACTIVE_DIRECTORY
TrustAttributes : WITHIN_FOREST
TrustDirection  : Bidirectional
WhenCreated     : 7/5/2019 7:48:23 AM
WhenChanged     : 11/19/2023 9:01:50 AM

SourceName      : us.techcorp.local
TargetName      : eu.local
TrustType       : WINDOWS_ACTIVE_DIRECTORY
TrustAttributes : FILTER_SIDS
TrustDirection  : Bidirectional
WhenCreated     : 7/13/2019 11:17:35 AM
WhenChanged     : 12/7/2023 9:02:36 AM
```
- We have a `WITHIN_FOREST`, `Bidirectional` trust with `TECHCORP.LOCAL`. This means that the trusted domain is within the same forest, indicating a parent->child or cross-link relationship.
- We have a `FILTER_SIDS`, `Bidirectional` trust with `EU.LOCAL`. This indicates a `QUARANTINED_DOMAIN` which means that SID filtering is enabled. This indicates a _Forest_ or an _External_ trust.
- Both have a `WINDOWS_ACTIVE_DIRECTORY` trust type, indicating that the other Windows domains are running Active Directory.
#### Domain Trusts Mapping
- We can use the `Get-DomainTrustMapping` function of **PowerView** to query any **(objectClass=trustedDomain)** objects from domains that currently trust our domain and keep issuing these queries for any results and “crawl” any reachable domains. Any domains marked as non-transitive can mess these results up, but we can still get a good number of results.
```powershell
PS C:\Auditor> Get-DomainTrustMapping


SourceName      : us.techcorp.local
TargetName      : techcorp.local
TrustType       : WINDOWS_ACTIVE_DIRECTORY
TrustAttributes : WITHIN_FOREST
TrustDirection  : Bidirectional
WhenCreated     : 7/5/2019 7:48:23 AM
WhenChanged     : 11/19/2023 9:01:50 AM

SourceName      : us.techcorp.local
TargetName      : eu.local
TrustType       : WINDOWS_ACTIVE_DIRECTORY
TrustAttributes : FILTER_SIDS
TrustDirection  : Bidirectional
WhenCreated     : 7/13/2019 11:17:35 AM
WhenChanged     : 12/7/2023 9:02:36 AM

SourceName      : eu.local
TargetName      : us.techcorp.local
TrustType       : WINDOWS_ACTIVE_DIRECTORY
TrustAttributes : FILTER_SIDS
TrustDirection  : Bidirectional
WhenCreated     : 7/13/2019 11:17:35 AM
WhenChanged     : 12/3/2023 5:01:39 AM

SourceName      : eu.local
TargetName      : euvendor.local
TrustType       : WINDOWS_ACTIVE_DIRECTORY
TrustAttributes : TREAT_AS_EXTERNAL,FOREST_TRANSITIVE
TrustDirection  : Bidirectional
WhenCreated     : 7/14/2019 10:57:12 AM
WhenChanged     : 12/3/2023 5:17:36 AM

SourceName      : techcorp.local
TargetName      : us.techcorp.local
TrustType       : WINDOWS_ACTIVE_DIRECTORY
TrustAttributes : WITHIN_FOREST
TrustDirection  : Bidirectional
WhenCreated     : 7/5/2019 7:48:23 AM
WhenChanged     : 11/19/2023 9:01:50 AM

SourceName      : techcorp.local
TargetName      : usvendor.local
TrustType       : WINDOWS_ACTIVE_DIRECTORY
TrustAttributes : FOREST_TRANSITIVE
TrustDirection  : Bidirectional
WhenCreated     : 7/13/2019 7:23:45 AM
WhenChanged     : 12/6/2023 11:42:28 AM

SourceName      : techcorp.local
TargetName      : bastion.local
TrustType       : WINDOWS_ACTIVE_DIRECTORY
TrustAttributes : FOREST_TRANSITIVE
TrustDirection  : Inbound
WhenCreated     : 7/14/2019 1:44:07 PM
WhenChanged     : 7/16/2023 4:05:36 AM

SourceName      : bastion.local
TargetName      : techcorp.local
TrustType       : WINDOWS_ACTIVE_DIRECTORY
TrustAttributes : FOREST_TRANSITIVE
TrustDirection  : Outbound
WhenCreated     : 7/14/2019 1:44:07 PM
WhenChanged     : 12/7/2023 5:00:11 AM

SourceName      : bastion.local
TargetName      : production.local
TrustType       : WINDOWS_ACTIVE_DIRECTORY
TrustAttributes : FOREST_TRANSITIVE
TrustDirection  : Inbound
WhenCreated     : 7/14/2019 1:57:25 PM
WhenChanged     : 12/7/2023 5:18:18 AM

SourceName      : usvendor.local
TargetName      : techcorp.local
TrustType       : WINDOWS_ACTIVE_DIRECTORY
TrustAttributes : FOREST_TRANSITIVE
TrustDirection  : Bidirectional
WhenCreated     : 7/13/2019 7:23:45 AM
WhenChanged     : 12/6/2023 11:42:28 AM
```
- A visualized version of the output above is the following (green = within forest, red = external, blue = forest to forest, black = MIT, violet = unrecognized).
![[trust_mapping.png]]
#### Domain Users
- We will enumerate all domain users except the ones that belong to students.
```powershell
PS C:\Auditor> Get-DomainUser | Select-Object samaccountname,description | Where-Object -Property samaccountname -notlike "student*"

samaccountname       description
--------------       -----------
Administrator        Built-in account for administering the computer/domain
Guest                Built-in account for guest access to the computer/domain
krbtgt               Key Distribution Center Service Account
emptest
adconnect
mgmtadmin
helpdeskadmin
dbservice
atauser
exchangeadmin
HealthMailbox3bd1057
HealthMailboxc8de558
HealthMailbox01f72be
HealthMailbox128342c
HealthMailboxbb3d25e
HealthMailbox87cf12f
HealthMailboxd517735
HealthMailbox86956b9
HealthMailbox307c425
HealthMailbox7f97592
HealthMailboxd933b3c
exchangemanager
exchangeuser
pawadmin
jwilliams
webmaster
serviceaccount
devuser
testda
decda
appsvc
provisioningsvc
Support51user
Support52user
Support53user
Support54user
Support55user
Support56user
Support57user
Support58user
Support59user
Support60user
Support61user
Support62user
Support63user
Support64user
Support65user
Support66user
Support67user
Support68user
Support69user
Support70user
```
#### Domain Computers
- We will enumerate all domain users except the ones that are student machines.
```powershell
PS C:\Auditor> Get-DomainComputer | Select-Object -Property distinguishedname,samaccountname,operatingsystem,serviceprincipalname,cn,dnshostname | Where-Object -Property samaccountname -notlike "student*"


distinguishedname    : CN=US-DC,OU=Domain Controllers,DC=us,DC=techcorp,DC=local
samaccountname       : US-DC$
operatingsystem      : Windows Server 2019 Standard
serviceprincipalname : {exchangeAB/US-DC, exchangeAB/US-DC.us.techcorp.local, ldap/US-DC.us.techcorp.local/DomainDnsZones.us.techcorp.local,
                       ldap/US-DC.us.techcorp.local/ForestDnsZones.techcorp.local...}
cn                   : US-DC
dnshostname          : US-DC.us.techcorp.local

distinguishedname    : CN=US-EXCHANGE,CN=Computers,DC=us,DC=techcorp,DC=local
samaccountname       : US-EXCHANGE$
operatingsystem      : Windows Server 2019 Standard
serviceprincipalname : {IMAP/US-EXCHANGE, IMAP/US-Exchange.us.techcorp.local, IMAP4/US-EXCHANGE, IMAP4/US-Exchange.us.techcorp.local...}
cn                   : US-EXCHANGE
dnshostname          : US-Exchange.us.techcorp.local

distinguishedname    : CN=US-MGMT,OU=Mgmt,DC=us,DC=techcorp,DC=local
samaccountname       : US-MGMT$
operatingsystem      : Windows Server 2019 Standard
serviceprincipalname : {WSMAN/US-Mgmt, WSMAN/US-Mgmt.us.techcorp.local, TERMSRV/US-MGMT, TERMSRV/US-Mgmt.us.techcorp.local...}
cn                   : US-MGMT
dnshostname          : US-Mgmt.us.techcorp.local

distinguishedname    : CN=US-HELPDESK,CN=Computers,DC=us,DC=techcorp,DC=local
samaccountname       : US-HELPDESK$
operatingsystem      : Windows Server 2019 Standard
serviceprincipalname : {TERMSRV/US-HELPDESK, TERMSRV/US-HelpDesk.us.techcorp.local, WSMAN/US-HelpDesk, WSMAN/US-HelpDesk.us.techcorp.local...}
cn                   : US-HELPDESK
dnshostname          : US-HelpDesk.us.techcorp.local

distinguishedname    : CN=US-MSSQL,CN=Computers,DC=us,DC=techcorp,DC=local
samaccountname       : US-MSSQL$
operatingsystem      : Windows Server 2019 Standard
serviceprincipalname : {MSSQLSvc/us-mssql.us.techcorp.local, WSMAN/US-MSSQL, WSMAN/US-MSSQL.us.techcorp.local, TERMSRV/US-MSSQL...}
cn                   : US-MSSQL
dnshostname          : US-MSSQL.us.techcorp.local

distinguishedname    : CN=US-MAILMGMT,OU=MailMgmt,DC=us,DC=techcorp,DC=local
samaccountname       : US-MAILMGMT$
operatingsystem      : Windows Server 2019 Standard
serviceprincipalname : {WSMAN/US-MailMgmt, WSMAN/US-MailMgmt.us.techcorp.local, TERMSRV/US-MAILMGMT, TERMSRV/US-MailMgmt.us.techcorp.local...}
cn                   : US-MAILMGMT
dnshostname          : US-MailMgmt.us.techcorp.local

distinguishedname    : CN=US-JUMP,OU=PAW,DC=us,DC=techcorp,DC=local
samaccountname       : US-JUMP$
operatingsystem      : Windows Server 2019 Standard
serviceprincipalname : {TERMSRV/US-JUMP, TERMSRV/US-Jump.us.techcorp.local, WSMAN/US-Jump, WSMAN/US-Jump.us.techcorp.local...}
cn                   : US-JUMP
dnshostname          : US-Jump.us.techcorp.local

distinguishedname    : CN=US-WEB,CN=Computers,DC=us,DC=techcorp,DC=local
samaccountname       : US-WEB$
operatingsystem      : Windows Server 2019 Standard
serviceprincipalname : {TERMSRV/US-WEB, TERMSRV/US-Web.us.techcorp.local, WSMAN/US-Web, WSMAN/US-Web.us.techcorp.local...}
cn                   : US-WEB
dnshostname          : US-Web.us.techcorp.local

distinguishedname    : CN=US-ADCONNECT,CN=Computers,DC=us,DC=techcorp,DC=local
samaccountname       : US-ADCONNECT$
operatingsystem      : Windows Server 2019 Standard
serviceprincipalname : {WSMAN/US-ADConnect, WSMAN/US-ADConnect.us.techcorp.local, TERMSRV/US-ADCONNECT,
                       TERMSRV/US-ADConnect.us.techcorp.local...}
cn                   : US-ADCONNECT
dnshostname          : US-ADConnect.us.techcorp.local

distinguishedname    : CN=jumpone,CN=Managed Service Accounts,DC=us,DC=techcorp,DC=local
samaccountname       : jumpone$
operatingsystem      :
serviceprincipalname :
cn                   : jumpone
dnshostname          : jump1.us.techcorp.local
```
#### Domain Groups
```powershell
PS C:\Auditor> Get-DomainGroup | Select-Object -Property cn,description

cn                                      description
--                                      -----------
Administrators                          Administrators have complete and unrestricted access to the computer/domain
Users                                   Users are prevented from making accidental or intentional system-wide changes and can run most appl...
Guests                                  Guests have the same access as members of the Users group by default, except for the Guest account ...
Print Operators                         Members can administer printers installed on domain controllers
Backup Operators                        Backup Operators can override security restrictions for the sole purpose of backing up or restoring...
Replicator                              Supports file replication in a domain
Remote Desktop Users                    Members in this group are granted the right to logon remotely
Network Configuration Operators         Members in this group can have some administrative privileges to manage configuration of networking...
Performance Monitor Users               Members of this group can access performance counter data locally and remotely
Performance Log Users                   Members of this group may schedule logging of performance counters, enable trace providers, and col...
Distributed COM Users                   Members are allowed to launch, activate and use Distributed COM objects on this machine.
IIS_IUSRS                               Built-in group used by Internet Information Services.
Cryptographic Operators                 Members are authorized to perform cryptographic operations.
Event Log Readers                       Members of this group can read event logs from local machine
Certificate Service DCOM Access         Members of this group are allowed to connect to Certification Authorities in the enterprise
RDS Remote Access Servers               Servers in this group enable users of RemoteApp programs and personal virtual desktops access to th...
RDS Endpoint Servers                    Servers in this group run virtual machines and host sessions where users RemoteApp programs and per...
RDS Management Servers                  Servers in this group can perform routine administrative actions on servers running Remote Desktop ...
Hyper-V Administrators                  Members of this group have complete and unrestricted access to all features of Hyper-V.
Access Control Assistance Operators     Members of this group can remotely query authorization attributes and permissions for resources on ...
Remote Management Users                 Members of this group can access WMI resources over management protocols (such as WS-Management via...
Storage Replica Administrators          Members of this group have complete and unrestricted access to all features of Storage Replica.
Domain Computers                        All workstations and servers joined to the domain
Domain Controllers                      All domain controllers in the domain
Cert Publishers                         Members of this group are permitted to publish certificates to the directory
Domain Admins                           Designated administrators of the domain
Domain Users                            All domain users
Domain Guests                           All domain guests
Group Policy Creator Owners             Members in this group can modify group policy for the domain
RAS and IAS Servers                     Servers in this group can access remote access properties of users
Server Operators                        Members can administer domain servers
Account Operators                       Members can administer domain user and group accounts
Pre-Windows 2000 Compatible Access      A backward compatibility group which allows read access on all users and groups in the domain
Windows Authorization Access Group      Members of this group have access to the computed tokenGroupsGlobalAndUniversal attribute on User o...
Terminal Server License Servers         Members of this group can update user accounts in Active Directory with information about license i...
Allowed RODC Password Replication Group Members in this group can have their passwords replicated to all read-only domain controllers in th...
Denied RODC Password Replication Group  Members in this group cannot have their passwords replicated to any read-only domain controllers in...
Read-only Domain Controllers            Members of this group are Read-Only Domain Controllers in the domain
Cloneable Domain Controllers            Members of this group that are domain controllers may be cloned.
Protected Users                         Members of this group are afforded additional protections against authentication security threats. ...
Key Admins                              Members of this group can perform administrative actions on key objects within the domain.
DnsAdmins                               DNS Administrators Group
DnsUpdateProxy                          DNS clients who are permitted to perform dynamic updates on behalf of some other clients (such as D...
StudentUsers                            Student Users Group
Managers                                Group to Manage Mgmt OU
MachineAdmins                           Group to manage machines of the Mgmt OU
MaintenanceUsers                        maintenanceusers
Exchange Install Domain Servers         This group is used during Exchange setup and is not intended to be used for other purposes.
```
#### Domain OUs
```powershell
PS C:\Auditor> Get-DomainOU | Select-Object ou,gplink,objectguid | Format-List


ou         : Domain Controllers
gplink     : [LDAP://CN={6AC1786C-016F-11D2-945F-00C04fB984F9},CN=Policies,CN=System,DC=us,DC=techcorp,DC=local;0]
objectguid : fc0dd146-a66e-45cc-83ae-9e5a0c39ed91

ou         : Mgmt
gplink     : [LDAP://cn={B78BFC6B-76DB-4AA4-9CF6-26260697A8F9},cn=policies,cn=system,DC=us,DC=techcorp,DC=local;0]
objectguid : 0fa90533-edbd-44a7-800e-41ff4ff46285

ou         : MailMgmt
gplink     : [LDAP://cn={7162874B-E6F0-45AD-A3BF-0858DA4FA02F},cn=policies,cn=system,DC=us,DC=techcorp,DC=local;0]
objectguid : a4a7cc10-e139-4fc7-916e-a76ae5659bf0

ou         : PAW
gplink     : [LDAP://cn={AFC6881A-5AB6-41D0-91C6-F2390899F102},cn=policies,cn=system,DC=us,DC=techcorp,DC=local;0]
objectguid : 1e5c43b5-1f1d-4670-ae65-1df745c9083c

ou         : Students
gplink     : [LDAP://cn={FCE16496-C744-4E46-AC89-2D01D76EAD68},cn=policies,cn=system,DC=us,DC=techcorp,DC=local;0]
objectguid : 690743cb-3f54-411c-b014-9879a8b1e054
```
#### Domain GPOs
```powershell
PS C:\Auditor> Get-DomainGPO | Select-Object displayname,gpcmachineextensionnames,name,objectguid | Format-List


displayname              : Default Domain Policy
gpcmachineextensionnames : [{35378EAC-683F-11D2-A89A-00C04FBBCFA2}{53D6AB1B-2488-11D1-A28C-00C04FB94F17}{D02B1F72-3407-48AE-BA88-E8213C6761F1}
                           ][{827D319E-6EAC-11D2-A4EA-00C04F79F83A}{803E14A0-B4FB-11D0-A0D0-00A0C90F574B}][{B1BE8D72-6EAC-11D2-A4EA-00C04F79F8
                           3A}{53D6AB1B-2488-11D1-A28C-00C04FB94F17}]
name                     : {31B2F340-016D-11D2-945F-00C04FB984F9}
objectguid               : d0907c7b-9e3e-42e9-ba50-ac23ea8bb598

displayname              : Default Domain Controllers Policy
gpcmachineextensionnames : [{827D319E-6EAC-11D2-A4EA-00C04F79F83A}{803E14A0-B4FB-11D0-A0D0-00A0C90F574B}]
name                     : {6AC1786C-016F-11D2-945F-00C04fB984F9}
objectguid               : 4a3e8abf-cb34-4876-be94-ae7b32239c2e

displayname              : MailMgmt
gpcmachineextensionnames : [{35378EAC-683F-11D2-A89A-00C04FBBCFA2}{D02B1F72-3407-48AE-BA88-E8213C6761F1}][{827D319E-6EAC-11D2-A4EA-00C04F79F83
                           A}{803E14A0-B4FB-11D0-A0D0-00A0C90F574B}][{D76B9641-3288-4F75-942D-087DE603E3EA}{D02B1F72-3407-48AE-BA88-E8213C6761
                           F1}]
name                     : {7162874B-E6F0-45AD-A3BF-0858DA4FA02F}
objectguid               : 0db7d2aa-c1cb-42c2-87f4-71462d0fdad1

displayname              : PAW
gpcmachineextensionnames : [{35378EAC-683F-11D2-A89A-00C04FBBCFA2}{D02B1F72-3407-48AE-BA88-E8213C6761F1}][{827D319E-6EAC-11D2-A4EA-00C04F79F83
                           A}{803E14A0-B4FB-11D0-A0D0-00A0C90F574B}][{FC491EF1-C4AA-4CE1-B329-414B101DB823}{D02B1F72-3407-48AE-BA88-E8213C6761
                           F1}]
name                     : {AFC6881A-5AB6-41D0-91C6-F2390899F102}
objectguid               : 34c56720-b64e-49a9-a629-0c4753100c15

displayname              : Mgmt
gpcmachineextensionnames : [{827D319E-6EAC-11D2-A4EA-00C04F79F83A}{803E14A0-B4FB-11D0-A0D0-00A0C90F574B}]
name                     : {B78BFC6B-76DB-4AA4-9CF6-26260697A8F9}
objectguid               : 6dfdcad7-ecfa-46ca-91ad-869112490e8f

displayname              : StudentPolicies
gpcmachineextensionnames : [{35378EAC-683F-11D2-A89A-00C04FBBCFA2}{D02B1F72-3407-48AE-BA88-E8213C6761F1}][{827D319E-6EAC-11D2-A4EA-00C04F79F83
                           A}{803E14A0-B4FB-11D0-A0D0-00A0C90F574B}]
name                     : {FCE16496-C744-4E46-AC89-2D01D76EAD68}
objectguid               : b9bb82a1-5cc2-4264-b4f4-bdf6a238817b
```
#### OUs and GPOs Combined
```powershell
PS C:\Auditor> $OUs = Get-DomainOU -Properties displayName, gplink; foreach ($OU in $OUs) { $FilteredLDAP = $OU.gplink -replace '.*\{(.+?)\}.*', '{$1}'; Write-Host "OU: $($OU.displayName)" -ForegroundColor "Yellow"; Get-DomainGPO -Identity $FilteredLDAP; Write-Host }
OU:


usncreated               : 7796
systemflags              : -1946157056
displayname              : Default Domain Controllers Policy
gpcmachineextensionnames : [{827D319E-6EAC-11D2-A4EA-00C04F79F83A}{803E14A0-B4FB-11D0-A0D0-00A0C90F574B}]
whenchanged              : 7/10/2019 4:00:04 PM
objectclass              : {top, container, groupPolicyContainer}
gpcfunctionalityversion  : 2
showinadvancedviewonly   : True
usnchanged               : 93743
dscorepropagationdata    : {7/30/2019 12:35:19 PM, 7/10/2019 4:00:03 PM, 7/10/2019 4:00:03 PM, 7/7/2019 4:11:13 AM...}
name                     : {6AC1786C-016F-11D2-945F-00C04fB984F9}
flags                    : 0
cn                       : {6AC1786C-016F-11D2-945F-00C04fB984F9}
iscriticalsystemobject   : True
gpcfilesyspath           : \\us.techcorp.local\sysvol\us.techcorp.local\Policies\{6AC1786C-016F-11D2-945F-00C04fB984F9}
distinguishedname        : CN={6AC1786C-016F-11D2-945F-00C04fB984F9},CN=Policies,CN=System,DC=us,DC=techcorp,DC=local
whencreated              : 7/5/2019 7:48:21 AM
versionnumber            : 2
instancetype             : 4
objectguid               : 4a3e8abf-cb34-4876-be94-ae7b32239c2e
objectcategory           : CN=Group-Policy-Container,CN=Schema,CN=Configuration,DC=techcorp,DC=local


OU: Mgmt
usncreated               : 161060
displayname              : Mgmt
gpcmachineextensionnames : [{827D319E-6EAC-11D2-A4EA-00C04F79F83A}{803E14A0-B4FB-11D0-A0D0-00A0C90F574B}]
whenchanged              : 7/15/2019 10:29:13 AM
objectclass              : {top, container, groupPolicyContainer}
gpcfunctionalityversion  : 2
showinadvancedviewonly   : True
usnchanged               : 161076
dscorepropagationdata    : {7/30/2019 12:35:19 PM, 1/1/1601 12:00:00 AM}
name                     : {B78BFC6B-76DB-4AA4-9CF6-26260697A8F9}
flags                    : 0
cn                       : {B78BFC6B-76DB-4AA4-9CF6-26260697A8F9}
gpcfilesyspath           : \\us.techcorp.local\SysVol\us.techcorp.local\Policies\{B78BFC6B-76DB-4AA4-9CF6-26260697A8F9}
distinguishedname        : CN={B78BFC6B-76DB-4AA4-9CF6-26260697A8F9},CN=Policies,CN=System,DC=us,DC=techcorp,DC=local
whencreated              : 7/15/2019 10:28:28 AM
versionnumber            : 2
instancetype             : 4
objectguid               : 6dfdcad7-ecfa-46ca-91ad-869112490e8f
objectcategory           : CN=Group-Policy-Container,CN=Schema,CN=Configuration,DC=techcorp,DC=local


OU: MailMgmt
usncreated               : 101297
displayname              : MailMgmt
gpcmachineextensionnames : [{35378EAC-683F-11D2-A89A-00C04FBBCFA2}{D02B1F72-3407-48AE-BA88-E8213C6761F1}][{827D319E-6EAC-11D2-A4EA-00C04F79F83
                           A}{803E14A0-B4FB-11D0-A0D0-00A0C90F574B}][{D76B9641-3288-4F75-942D-087DE603E3EA}{D02B1F72-3407-48AE-BA88-E8213C6761
                           F1}]
whenchanged              : 7/20/2019 11:40:44 AM
objectclass              : {top, container, groupPolicyContainer}
gpcfunctionalityversion  : 2
showinadvancedviewonly   : True
usnchanged               : 329869
dscorepropagationdata    : {7/30/2019 12:35:19 PM, 1/1/1601 12:00:00 AM}
name                     : {7162874B-E6F0-45AD-A3BF-0858DA4FA02F}
flags                    : 0
cn                       : {7162874B-E6F0-45AD-A3BF-0858DA4FA02F}
gpcfilesyspath           : \\us.techcorp.local\SysVol\us.techcorp.local\Policies\{7162874B-E6F0-45AD-A3BF-0858DA4FA02F}
distinguishedname        : CN={7162874B-E6F0-45AD-A3BF-0858DA4FA02F},CN=Policies,CN=System,DC=us,DC=techcorp,DC=local
whencreated              : 7/11/2019 5:04:51 AM
versionnumber            : 7
instancetype             : 4
objectguid               : 0db7d2aa-c1cb-42c2-87f4-71462d0fdad1
objectcategory           : CN=Group-Policy-Container,CN=Schema,CN=Configuration,DC=techcorp,DC=local


OU: PAW
usncreated               : 117912
displayname              : PAW
gpcmachineextensionnames : [{35378EAC-683F-11D2-A89A-00C04FBBCFA2}{D02B1F72-3407-48AE-BA88-E8213C6761F1}][{827D319E-6EAC-11D2-A4EA-00C04F79F83
                           A}{803E14A0-B4FB-11D0-A0D0-00A0C90F574B}][{FC491EF1-C4AA-4CE1-B329-414B101DB823}{D02B1F72-3407-48AE-BA88-E8213C6761
                           F1}]
whenchanged              : 1/8/2021 1:51:31 PM
objectclass              : {top, container, groupPolicyContainer}
gpcfunctionalityversion  : 2
showinadvancedviewonly   : True
usnchanged               : 1942061
dscorepropagationdata    : {7/30/2019 12:35:19 PM, 1/1/1601 12:00:00 AM}
name                     : {AFC6881A-5AB6-41D0-91C6-F2390899F102}
flags                    : 0
cn                       : {AFC6881A-5AB6-41D0-91C6-F2390899F102}
gpcfilesyspath           : \\us.techcorp.local\SysVol\us.techcorp.local\Policies\{AFC6881A-5AB6-41D0-91C6-F2390899F102}
distinguishedname        : CN={AFC6881A-5AB6-41D0-91C6-F2390899F102},CN=Policies,CN=System,DC=us,DC=techcorp,DC=local
whencreated              : 7/12/2019 7:36:17 AM
versionnumber            : 11
instancetype             : 4
objectguid               : 34c56720-b64e-49a9-a629-0c4753100c15
objectcategory           : CN=Group-Policy-Container,CN=Schema,CN=Configuration,DC=techcorp,DC=local


OU: Students
usncreated               : 330304
displayname              : StudentPolicies
gpcmachineextensionnames : [{35378EAC-683F-11D2-A89A-00C04FBBCFA2}{D02B1F72-3407-48AE-BA88-E8213C6761F1}][{827D319E-6EAC-11D2-A4EA-00C04F79F83
                           A}{803E14A0-B4FB-11D0-A0D0-00A0C90F574B}]
whenchanged              : 7/20/2019 2:17:57 PM
objectclass              : {top, container, groupPolicyContainer}
gpcfunctionalityversion  : 2
showinadvancedviewonly   : True
usnchanged               : 338463
dscorepropagationdata    : {7/30/2019 12:35:19 PM, 1/1/1601 12:00:00 AM}
name                     : {FCE16496-C744-4E46-AC89-2D01D76EAD68}
flags                    : 0
cn                       : {FCE16496-C744-4E46-AC89-2D01D76EAD68}
gpcfilesyspath           : \\us.techcorp.local\SysVol\us.techcorp.local\Policies\{FCE16496-C744-4E46-AC89-2D01D76EAD68}
distinguishedname        : CN={FCE16496-C744-4E46-AC89-2D01D76EAD68},CN=Policies,CN=System,DC=us,DC=techcorp,DC=local
whencreated              : 7/20/2019 11:48:51 AM
versionnumber            : 4
instancetype             : 4
objectguid               : b9bb82a1-5cc2-4264-b4f4-bdf6a238817b
objectcategory           : CN=Group-Policy-Container,CN=Schema,CN=Configuration,DC=techcorp,DC=local
```
#### Domain Controllers
```powershell
PS C:\Auditor> Get-DomainController


Forest                     : techcorp.local
CurrentTime                : 12/8/2023 6:46:58 AM
HighestCommittedUsn        : 2449462
OSVersion                  : Windows Server 2019 Standard
Roles                      : {PdcRole, RidRole, InfrastructureRole}
Domain                     : us.techcorp.local
IPAddress                  : 192.168.1.2
SiteName                   : Default-First-Site-Name
SyncFromAllServersCallback :
InboundConnections         : {2b812d20-6cef-480e-aafd-04c79f9eb230}
OutboundConnections        : {543164f8-28fb-4097-b624-58098aabdbf0}
Name                       : US-DC.us.techcorp.local
Partitions                 : {CN=Configuration,DC=techcorp,DC=local, CN=Schema,CN=Configuration,DC=techcorp,DC=local,
                             DC=ForestDnsZones,DC=techcorp,DC=local, DC=us,DC=techcorp,DC=local...}
```
#### Domain Admins
```powershell
PS C:\Auditor> Get-DomainGroupMember -Identity "Domain Admins" -Recurse


GroupDomain             : us.techcorp.local
GroupName               : Domain Admins
GroupDistinguishedName  : CN=Domain Admins,CN=Users,DC=us,DC=techcorp,DC=local
MemberDomain            : us.techcorp.local
MemberName              : decda
MemberDistinguishedName : CN=decda,CN=Users,DC=us,DC=techcorp,DC=local
MemberObjectClass       : user
MemberSID               : S-1-5-21-210670787-2521448726-163245708-1289

GroupDomain             : us.techcorp.local
GroupName               : Domain Admins
GroupDistinguishedName  : CN=Domain Admins,CN=Users,DC=us,DC=techcorp,DC=local
MemberDomain            : us.techcorp.local
MemberName              : Administrator
MemberDistinguishedName : CN=Administrator,CN=Users,DC=us,DC=techcorp,DC=local
MemberObjectClass       : user
MemberSID               : S-1-5-21-210670787-2521448726-163245708-500
```
#### Accounts privileged for KUD
```powershell
PS C:\Auditor> Get-DomainComputer -TrustedToAuth | select samaccountname,msds-allowedtodelegateto

samaccountname msds-allowedtodelegateto
-------------- ------------------------
US-MGMT$       {cifs/US-MSSQL.us.techcorp.local, cifs/US-MSSQL}
```
#### Accounts privileged for KCD
```powershell
PS C:\Auditor> Get-DomainComputer -TrustedToAuth | select samaccountname,msds-allowedtodelegateto

samaccountname msds-allowedtodelegateto
-------------- ------------------------
US-MGMT$       {cifs/US-MSSQL.us.techcorp.local, cifs/US-MSSQL}

PS C:\Auditor> Get-DomainUser -TrustedToAuth | select samaccountname,msds-allowedtodelegateto

samaccountname msds-allowedtodelegateto
-------------- ------------------------
appsvc         {CIFS/us-mssql.us.techcorp.local, CIFS/us-mssql}
```
#### Accounts Privileged for RBCD
```powershell
PS C:\Auditor> $usersid = get-domainuser | select -exp objectsid; "Got user SIDS"; $computeracls = Get-DomainComputer | select -exp dnshostname | get-domainobjectacl; "Got computer ACLs"; "Search through acls for RBCD..."; foreach ($acl in $computeracls) { foreach($sid in $usersid) { $acl | ?{$_.SecurityIdentifier -eq $sid -and ($_.ActiveDirectoryRights -Like '*GenericAll*' -or $_.ActiveDirectoryRights -Like '*GenericWrite*' -or $_.ActiveDirectoryRights -Like '*WriteOwner*')} } }
Got user SIDS
Got computer ACLs
Search through acls for RBCD...


ObjectDN              : CN=US-HELPDESK,CN=Computers,DC=us,DC=techcorp,DC=local
ObjectSID             : S-1-5-21-210670787-2521448726-163245708-1106
ActiveDirectoryRights : ListChildren, ReadProperty, GenericWrite
BinaryLength          : 36
AceQualifier          : AccessAllowed
IsCallback            : False
OpaqueLength          : 0
AccessMask            : 131132
SecurityIdentifier    : S-1-5-21-210670787-2521448726-163245708-1115
AceType               : AccessAllowed
AceFlags              : None
IsInherited           : False
InheritanceFlags      : None
PropagationFlags      : None
AuditFlags            : None


PS C:\Auditor> ConvertFrom-SID S-1-5-21-210670787-2521448726-163245708-1115
US\mgmtadmin
```
#### Members of Interesting Domain Groups
```powershell
PS C:\Auditor> Get-DomainGroupMember -Name Managers


GroupDomain             : us.techcorp.local
GroupName               : managers
GroupDistinguishedName  : CN=Managers,CN=Users,DC=us,DC=techcorp,DC=local
MemberDomain            : us.techcorp.local
MemberName              : maintenanceusers
MemberDistinguishedName : CN=MaintenanceUsers,CN=Users,DC=us,DC=techcorp,DC=local
MemberObjectClass       : group
MemberSID               : S-1-5-21-210670787-2521448726-163245708-1119

PS C:\Auditor> Get-DomainGroupMember -Name maintenanceusers


GroupDomain             : us.techcorp.local
GroupName               : maintenanceusers
GroupDistinguishedName  : CN=MaintenanceUsers,CN=Users,DC=us,DC=techcorp,DC=local
MemberDomain            : us.techcorp.local
MemberName              : studentusers
MemberDistinguishedName : CN=StudentUsers,CN=Users,DC=us,DC=techcorp,DC=local
MemberObjectClass       : group
MemberSID               : S-1-5-21-210670787-2521448726-163245708-1116
```
#### Members of Interesting OUs
```powershell
PS C:\Auditor> (Get-DomainOU -Identity Mgmt).distinguishedname | %{Get-DomainComputer -SearchBase $_} | select name

name
----
US-MGMT

PS C:\Auditor> (Get-DomainOU -Identity MailMgmt).distinguishedname | %{Get-DomainComputer -SearchBase $_} | select name

name
----
US-MAILMGMT

PS C:\Auditor> (Get-DomainOU -Identity PAW).distinguishedname | %{Get-DomainComputer -SearchBase $_} | select name

name
----
US-JUMP
```
#### Domain Users with SPNs
```powershell
PS C:\Auditor> Get-DomainUser -SPN | Select-Object samaccountname,serviceprincipalname

samaccountname serviceprincipalname
-------------- --------------------
krbtgt         kadmin/changepw
serviceaccount USSvc/serviceaccount
appsvc         appsvc/us-jump.us.techcorp.local
```
#### Certificate Authorities
```powershell
PS C:\Auditor> .\Certify.exe cas

   _____          _   _  __
  / ____|        | | (_)/ _|
 | |     ___ _ __| |_ _| |_ _   _
 | |    / _ \ '__| __| |  _| | | |
 | |___|  __/ |  | |_| | | | |_| |
  \_____\___|_|   \__|_|_|  \__, |
                             __/ |
                            |___./
  v1.1.0

[*] Action: Find certificate authorities
[*] Using the search base 'CN=Configuration,DC=techcorp,DC=local'


[*] Root CAs

    Cert SubjectName              : CN=TECHCORP-DC-CA, DC=techcorp, DC=local
    Cert Thumbprint               : F95C7E9F28F50C87F309A6EFB2CB3AEB0B2FAC86
    Cert Serial                   : 4F3F87A449C15587446B046111AA6313
    Cert Start Date               : 7/12/2019 12:02:05 AM
    Cert End Date                 : 7/12/2024 12:12:04 AM
    Cert Chain                    : CN=TECHCORP-DC-CA,DC=techcorp,DC=local



[*] NTAuthCertificates - Certificates that enable authentication:

    Cert SubjectName              : CN=TECHCORP-DC-CA, DC=techcorp, DC=local
    Cert Thumbprint               : F95C7E9F28F50C87F309A6EFB2CB3AEB0B2FAC86
    Cert Serial                   : 4F3F87A449C15587446B046111AA6313
    Cert Start Date               : 7/12/2019 12:02:05 AM
    Cert End Date                 : 7/12/2024 12:12:04 AM
    Cert Chain                    : CN=TECHCORP-DC-CA,DC=techcorp,DC=local


[*] Enterprise/Enrollment CAs:

    Enterprise CA Name            : TECHCORP-DC-CA
    DNS Hostname                  : Techcorp-DC.techcorp.local
    FullName                      : Techcorp-DC.techcorp.local\TECHCORP-DC-CA
    Flags                         : SUPPORTS_NT_AUTHENTICATION, CA_SERVERTYPE_ADVANCED
    Cert SubjectName              : CN=TECHCORP-DC-CA, DC=techcorp, DC=local
    Cert Thumbprint               : F95C7E9F28F50C87F309A6EFB2CB3AEB0B2FAC86
    Cert Serial                   : 4F3F87A449C15587446B046111AA6313
    Cert Start Date               : 7/12/2019 12:02:05 AM
    Cert End Date                 : 7/12/2024 12:12:04 AM
    Cert Chain                    : CN=TECHCORP-DC-CA,DC=techcorp,DC=local
    UserSpecifiedSAN              : Disabled
    CA Permissions                :
      Owner: BUILTIN\Administrators        S-1-5-32-544

      Access Rights                                     Principal

      Allow  Enroll                                     NT AUTHORITY\Authenticated UsersS-1-5-11
      Allow  ManageCA, ManageCertificates               BUILTIN\Administrators        S-1-5-32-544
      Allow  ManageCA, ManageCertificates               TECHCORP\Domain Admins        S-1-5-21-2781415573-3701854478-2406986946-512
      Allow  ManageCA, ManageCertificates               TECHCORP\Enterprise Admins    S-1-5-21-2781415573-3701854478-2406986946-519
    Enrollment Agent Restrictions : None

    Enabled Certificate Templates:
        ForAdminsofPrivilegedAccessWorkstations
        Users
        WDAC
        DirectoryEmailReplication
        DomainControllerAuthentication
        KerberosAuthentication
        EFSRecovery
        EFS
        DomainController
        WebServer
        Machine
        User
        SubCA
        Administrator
```
#### Certificate Templates
```powershell
PS C:\Auditor> .\Certify.exe find

   _____          _   _  __
  / ____|        | | (_)/ _|
 | |     ___ _ __| |_ _| |_ _   _
 | |    / _ \ '__| __| |  _| | | |
 | |___|  __/ |  | |_| | | | |_| |
  \_____\___|_|   \__|_|_|  \__, |
                             __/ |
                            |___./
  v1.1.0

[*] Action: Find certificate templates
[*] Using the search base 'CN=Configuration,DC=techcorp,DC=local'

[*] Listing info about the Enterprise CA 'TECHCORP-DC-CA'

    Enterprise CA Name            : TECHCORP-DC-CA
    DNS Hostname                  : Techcorp-DC.techcorp.local
    FullName                      : Techcorp-DC.techcorp.local\TECHCORP-DC-CA
    Flags                         : SUPPORTS_NT_AUTHENTICATION, CA_SERVERTYPE_ADVANCED
    Cert SubjectName              : CN=TECHCORP-DC-CA, DC=techcorp, DC=local
    Cert Thumbprint               : F95C7E9F28F50C87F309A6EFB2CB3AEB0B2FAC86
    Cert Serial                   : 4F3F87A449C15587446B046111AA6313
    Cert Start Date               : 7/12/2019 12:02:05 AM
    Cert End Date                 : 7/12/2024 12:12:04 AM
    Cert Chain                    : CN=TECHCORP-DC-CA,DC=techcorp,DC=local
    UserSpecifiedSAN              : Disabled
    CA Permissions                :
      Owner: BUILTIN\Administrators        S-1-5-32-544

      Access Rights                                     Principal

      Allow  Enroll                                     NT AUTHORITY\Authenticated UsersS-1-5-11
      Allow  ManageCA, ManageCertificates               BUILTIN\Administrators        S-1-5-32-544
      Allow  ManageCA, ManageCertificates               TECHCORP\Domain Admins        S-1-5-21-2781415573-3701854478-2406986946-512
      Allow  ManageCA, ManageCertificates               TECHCORP\Enterprise Admins    S-1-5-21-2781415573-3701854478-2406986946-519
    Enrollment Agent Restrictions : None

[*] Available Certificates Templates :

    CA Name                               : Techcorp-DC.techcorp.local\TECHCORP-DC-CA
    Template Name                         : User
    Schema Version                        : 1
    Validity Period                       : 1 year
    Renewal Period                        : 6 weeks
    msPKI-Certificate-Name-Flag          : SUBJECT_ALT_REQUIRE_UPN, SUBJECT_ALT_REQUIRE_EMAIL, SUBJECT_REQUIRE_EMAIL, SUBJECT_REQUIRE_DIRECTORY_PATH
    mspki-enrollment-flag                 : INCLUDE_SYMMETRIC_ALGORITHMS, PUBLISH_TO_DS, AUTO_ENROLLMENT
    Authorized Signatures Required        : 0
    pkiextendedkeyusage                   : Client Authentication, Encrypting File System, Secure Email
    mspki-certificate-application-policy  : <null>
    Permissions
      Enrollment Permissions
        Enrollment Rights           : TECHCORP\Domain Admins        S-1-5-21-2781415573-3701854478-2406986946-512
                                      TECHCORP\Domain Users         S-1-5-21-2781415573-3701854478-2406986946-513
                                      TECHCORP\Enterprise Admins    S-1-5-21-2781415573-3701854478-2406986946-519
      Object Control Permissions
        Owner                       : TECHCORP\Enterprise Admins    S-1-5-21-2781415573-3701854478-2406986946-519
        WriteOwner Principals       : TECHCORP\Domain Admins        S-1-5-21-2781415573-3701854478-2406986946-512
                                      TECHCORP\Enterprise Admins    S-1-5-21-2781415573-3701854478-2406986946-519
        WriteDacl Principals        : TECHCORP\Domain Admins        S-1-5-21-2781415573-3701854478-2406986946-512
                                      TECHCORP\Enterprise Admins    S-1-5-21-2781415573-3701854478-2406986946-519
        WriteProperty Principals    : TECHCORP\Domain Admins        S-1-5-21-2781415573-3701854478-2406986946-512
                                      TECHCORP\Enterprise Admins    S-1-5-21-2781415573-3701854478-2406986946-519

    CA Name                               : Techcorp-DC.techcorp.local\TECHCORP-DC-CA
    Template Name                         : EFS
    Schema Version                        : 1
    Validity Period                       : 1 year
    Renewal Period                        : 6 weeks
    msPKI-Certificate-Name-Flag          : SUBJECT_ALT_REQUIRE_UPN, SUBJECT_REQUIRE_DIRECTORY_PATH
    mspki-enrollment-flag                 : INCLUDE_SYMMETRIC_ALGORITHMS, PUBLISH_TO_DS, AUTO_ENROLLMENT
    Authorized Signatures Required        : 0
    pkiextendedkeyusage                   : Encrypting File System
    mspki-certificate-application-policy  : <null>
    Permissions
      Enrollment Permissions
        Enrollment Rights           : TECHCORP\Domain Admins        S-1-5-21-2781415573-3701854478-2406986946-512
                                      TECHCORP\Domain Users         S-1-5-21-2781415573-3701854478-2406986946-513
                                      TECHCORP\Enterprise Admins    S-1-5-21-2781415573-3701854478-2406986946-519
      Object Control Permissions
        Owner                       : TECHCORP\Enterprise Admins    S-1-5-21-2781415573-3701854478-2406986946-519
        WriteOwner Principals       : TECHCORP\Domain Admins        S-1-5-21-2781415573-3701854478-2406986946-512
                                      TECHCORP\Enterprise Admins    S-1-5-21-2781415573-3701854478-2406986946-519
        WriteDacl Principals        : TECHCORP\Domain Admins        S-1-5-21-2781415573-3701854478-2406986946-512
                                      TECHCORP\Enterprise Admins    S-1-5-21-2781415573-3701854478-2406986946-519
        WriteProperty Principals    : TECHCORP\Domain Admins        S-1-5-21-2781415573-3701854478-2406986946-512
                                      TECHCORP\Enterprise Admins    S-1-5-21-2781415573-3701854478-2406986946-519

    CA Name                               : Techcorp-DC.techcorp.local\TECHCORP-DC-CA
    Template Name                         : Administrator
    Schema Version                        : 1
    Validity Period                       : 1 year
    Renewal Period                        : 6 weeks
    msPKI-Certificate-Name-Flag          : SUBJECT_ALT_REQUIRE_UPN, SUBJECT_ALT_REQUIRE_EMAIL, SUBJECT_REQUIRE_EMAIL, SUBJECT_REQUIRE_DIRECTORY_PATH
    mspki-enrollment-flag                 : INCLUDE_SYMMETRIC_ALGORITHMS, PUBLISH_TO_DS, AUTO_ENROLLMENT
    Authorized Signatures Required        : 0
    pkiextendedkeyusage                   : Client Authentication, Encrypting File System, Microsoft Trust List Signing, Secure Email
    mspki-certificate-application-policy  : <null>
    Permissions
      Enrollment Permissions
        Enrollment Rights           : TECHCORP\Domain Admins        S-1-5-21-2781415573-3701854478-2406986946-512
                                      TECHCORP\Enterprise Admins    S-1-5-21-2781415573-3701854478-2406986946-519
      Object Control Permissions
        Owner                       : TECHCORP\Enterprise Admins    S-1-5-21-2781415573-3701854478-2406986946-519
        WriteOwner Principals       : TECHCORP\Domain Admins        S-1-5-21-2781415573-3701854478-2406986946-512
                                      TECHCORP\Enterprise Admins    S-1-5-21-2781415573-3701854478-2406986946-519
        WriteDacl Principals        : TECHCORP\Domain Admins        S-1-5-21-2781415573-3701854478-2406986946-512
                                      TECHCORP\Enterprise Admins    S-1-5-21-2781415573-3701854478-2406986946-519
        WriteProperty Principals    : TECHCORP\Domain Admins        S-1-5-21-2781415573-3701854478-2406986946-512
                                      TECHCORP\Enterprise Admins    S-1-5-21-2781415573-3701854478-2406986946-519

    CA Name                               : Techcorp-DC.techcorp.local\TECHCORP-DC-CA
    Template Name                         : EFSRecovery
    Schema Version                        : 1
    Validity Period                       : 5 years
    Renewal Period                        : 6 weeks
    msPKI-Certificate-Name-Flag          : SUBJECT_ALT_REQUIRE_UPN, SUBJECT_REQUIRE_DIRECTORY_PATH
    mspki-enrollment-flag                 : INCLUDE_SYMMETRIC_ALGORITHMS, AUTO_ENROLLMENT
    Authorized Signatures Required        : 0
    pkiextendedkeyusage                   : File Recovery
    mspki-certificate-application-policy  : <null>
    Permissions
      Enrollment Permissions
        Enrollment Rights           : TECHCORP\Domain Admins        S-1-5-21-2781415573-3701854478-2406986946-512
                                      TECHCORP\Enterprise Admins    S-1-5-21-2781415573-3701854478-2406986946-519
      Object Control Permissions
        Owner                       : TECHCORP\Enterprise Admins    S-1-5-21-2781415573-3701854478-2406986946-519
        WriteOwner Principals       : TECHCORP\Domain Admins        S-1-5-21-2781415573-3701854478-2406986946-512
                                      TECHCORP\Enterprise Admins    S-1-5-21-2781415573-3701854478-2406986946-519
        WriteDacl Principals        : TECHCORP\Domain Admins        S-1-5-21-2781415573-3701854478-2406986946-512
                                      TECHCORP\Enterprise Admins    S-1-5-21-2781415573-3701854478-2406986946-519
        WriteProperty Principals    : TECHCORP\Domain Admins        S-1-5-21-2781415573-3701854478-2406986946-512
                                      TECHCORP\Enterprise Admins    S-1-5-21-2781415573-3701854478-2406986946-519

    CA Name                               : Techcorp-DC.techcorp.local\TECHCORP-DC-CA
    Template Name                         : Machine
    Schema Version                        : 1
    Validity Period                       : 1 year
    Renewal Period                        : 6 weeks
    msPKI-Certificate-Name-Flag          : SUBJECT_ALT_REQUIRE_DNS, SUBJECT_REQUIRE_DNS_AS_CN
    mspki-enrollment-flag                 : AUTO_ENROLLMENT
    Authorized Signatures Required        : 0
    pkiextendedkeyusage                   : Client Authentication, Server Authentication
    mspki-certificate-application-policy  : <null>
    Permissions
      Enrollment Permissions
        Enrollment Rights           : TECHCORP\Domain Admins        S-1-5-21-2781415573-3701854478-2406986946-512
                                      TECHCORP\Domain Computers     S-1-5-21-2781415573-3701854478-2406986946-515
                                      TECHCORP\Enterprise Admins    S-1-5-21-2781415573-3701854478-2406986946-519
      Object Control Permissions
        Owner                       : TECHCORP\Enterprise Admins    S-1-5-21-2781415573-3701854478-2406986946-519
        WriteOwner Principals       : TECHCORP\Domain Admins        S-1-5-21-2781415573-3701854478-2406986946-512
                                      TECHCORP\Enterprise Admins    S-1-5-21-2781415573-3701854478-2406986946-519
        WriteDacl Principals        : TECHCORP\Domain Admins        S-1-5-21-2781415573-3701854478-2406986946-512
                                      TECHCORP\Enterprise Admins    S-1-5-21-2781415573-3701854478-2406986946-519
        WriteProperty Principals    : TECHCORP\Domain Admins        S-1-5-21-2781415573-3701854478-2406986946-512
                                      TECHCORP\Enterprise Admins    S-1-5-21-2781415573-3701854478-2406986946-519

    CA Name                               : Techcorp-DC.techcorp.local\TECHCORP-DC-CA
    Template Name                         : DomainController
    Schema Version                        : 1
    Validity Period                       : 1 year
    Renewal Period                        : 6 weeks
    msPKI-Certificate-Name-Flag          : SUBJECT_ALT_REQUIRE_DIRECTORY_GUID, SUBJECT_ALT_REQUIRE_DNS, SUBJECT_REQUIRE_DNS_AS_CN
    mspki-enrollment-flag                 : INCLUDE_SYMMETRIC_ALGORITHMS, PUBLISH_TO_DS, AUTO_ENROLLMENT
    Authorized Signatures Required        : 0
    pkiextendedkeyusage                   : Client Authentication, Server Authentication
    mspki-certificate-application-policy  : <null>
    Permissions
      Enrollment Permissions
        Enrollment Rights           : NT AUTHORITY\ENTERPRISE DOMAIN CONTROLLERSS-1-5-9
                                      TECHCORP\Domain Admins        S-1-5-21-2781415573-3701854478-2406986946-512
                                      TECHCORP\Domain Controllers   S-1-5-21-2781415573-3701854478-2406986946-516
                                      TECHCORP\Enterprise Admins    S-1-5-21-2781415573-3701854478-2406986946-519
                                      TECHCORP\Enterprise Read-only Domain ControllersS-1-5-21-2781415573-3701854478-2406986946-498
      Object Control Permissions
        Owner                       : TECHCORP\Enterprise Admins    S-1-5-21-2781415573-3701854478-2406986946-519
        WriteOwner Principals       : TECHCORP\Domain Admins        S-1-5-21-2781415573-3701854478-2406986946-512
                                      TECHCORP\Enterprise Admins    S-1-5-21-2781415573-3701854478-2406986946-519
        WriteDacl Principals        : TECHCORP\Domain Admins        S-1-5-21-2781415573-3701854478-2406986946-512
                                      TECHCORP\Enterprise Admins    S-1-5-21-2781415573-3701854478-2406986946-519
        WriteProperty Principals    : TECHCORP\Domain Admins        S-1-5-21-2781415573-3701854478-2406986946-512
                                      TECHCORP\Enterprise Admins    S-1-5-21-2781415573-3701854478-2406986946-519

    CA Name                               : Techcorp-DC.techcorp.local\TECHCORP-DC-CA
    Template Name                         : WebServer
    Schema Version                        : 1
    Validity Period                       : 2 years
    Renewal Period                        : 6 weeks
    msPKI-Certificate-Name-Flag          : ENROLLEE_SUPPLIES_SUBJECT
    mspki-enrollment-flag                 : NONE
    Authorized Signatures Required        : 0
    pkiextendedkeyusage                   : Server Authentication
    mspki-certificate-application-policy  : <null>
    Permissions
      Enrollment Permissions
        Enrollment Rights           : TECHCORP\Domain Admins        S-1-5-21-2781415573-3701854478-2406986946-512
                                      TECHCORP\Enterprise Admins    S-1-5-21-2781415573-3701854478-2406986946-519
      Object Control Permissions
        Owner                       : TECHCORP\Enterprise Admins    S-1-5-21-2781415573-3701854478-2406986946-519
        WriteOwner Principals       : TECHCORP\Domain Admins        S-1-5-21-2781415573-3701854478-2406986946-512
                                      TECHCORP\Enterprise Admins    S-1-5-21-2781415573-3701854478-2406986946-519
        WriteDacl Principals        : TECHCORP\Domain Admins        S-1-5-21-2781415573-3701854478-2406986946-512
                                      TECHCORP\Enterprise Admins    S-1-5-21-2781415573-3701854478-2406986946-519
        WriteProperty Principals    : TECHCORP\Domain Admins        S-1-5-21-2781415573-3701854478-2406986946-512
                                      TECHCORP\Enterprise Admins    S-1-5-21-2781415573-3701854478-2406986946-519

    CA Name                               : Techcorp-DC.techcorp.local\TECHCORP-DC-CA
    Template Name                         : SubCA
    Schema Version                        : 1
    Validity Period                       : 5 years
    Renewal Period                        : 6 weeks
    msPKI-Certificate-Name-Flag          : ENROLLEE_SUPPLIES_SUBJECT
    mspki-enrollment-flag                 : NONE
    Authorized Signatures Required        : 0
    pkiextendedkeyusage                   : <null>
    mspki-certificate-application-policy  : <null>
    Permissions
      Enrollment Permissions
        Enrollment Rights           : TECHCORP\Domain Admins        S-1-5-21-2781415573-3701854478-2406986946-512
                                      TECHCORP\Enterprise Admins    S-1-5-21-2781415573-3701854478-2406986946-519
      Object Control Permissions
        Owner                       : TECHCORP\Enterprise Admins    S-1-5-21-2781415573-3701854478-2406986946-519
        WriteOwner Principals       : TECHCORP\Domain Admins        S-1-5-21-2781415573-3701854478-2406986946-512
                                      TECHCORP\Enterprise Admins    S-1-5-21-2781415573-3701854478-2406986946-519
        WriteDacl Principals        : TECHCORP\Domain Admins        S-1-5-21-2781415573-3701854478-2406986946-512
                                      TECHCORP\Enterprise Admins    S-1-5-21-2781415573-3701854478-2406986946-519
        WriteProperty Principals    : TECHCORP\Domain Admins        S-1-5-21-2781415573-3701854478-2406986946-512
                                      TECHCORP\Enterprise Admins    S-1-5-21-2781415573-3701854478-2406986946-519

    CA Name                               : Techcorp-DC.techcorp.local\TECHCORP-DC-CA
    Template Name                         : DomainControllerAuthentication
    Schema Version                        : 2
    Validity Period                       : 1 year
    Renewal Period                        : 6 weeks
    msPKI-Certificate-Name-Flag          : SUBJECT_ALT_REQUIRE_DNS
    mspki-enrollment-flag                 : AUTO_ENROLLMENT
    Authorized Signatures Required        : 0
    pkiextendedkeyusage                   : Client Authentication, Server Authentication, Smart Card Logon
    mspki-certificate-application-policy  : Client Authentication, Server Authentication, Smart Card Logon
    Permissions
      Enrollment Permissions
        Enrollment Rights           : NT AUTHORITY\ENTERPRISE DOMAIN CONTROLLERSS-1-5-9
                                      TECHCORP\Domain Admins        S-1-5-21-2781415573-3701854478-2406986946-512
                                      TECHCORP\Domain Controllers   S-1-5-21-2781415573-3701854478-2406986946-516
                                      TECHCORP\Enterprise Admins    S-1-5-21-2781415573-3701854478-2406986946-519
                                      TECHCORP\Enterprise Read-only Domain ControllersS-1-5-21-2781415573-3701854478-2406986946-498
      Object Control Permissions
        Owner                       : TECHCORP\Enterprise Admins    S-1-5-21-2781415573-3701854478-2406986946-519
        WriteOwner Principals       : TECHCORP\Domain Admins        S-1-5-21-2781415573-3701854478-2406986946-512
                                      TECHCORP\Enterprise Admins    S-1-5-21-2781415573-3701854478-2406986946-519
        WriteDacl Principals        : TECHCORP\Domain Admins        S-1-5-21-2781415573-3701854478-2406986946-512
                                      TECHCORP\Enterprise Admins    S-1-5-21-2781415573-3701854478-2406986946-519
        WriteProperty Principals    : TECHCORP\Domain Admins        S-1-5-21-2781415573-3701854478-2406986946-512
                                      TECHCORP\Enterprise Admins    S-1-5-21-2781415573-3701854478-2406986946-519

    CA Name                               : Techcorp-DC.techcorp.local\TECHCORP-DC-CA
    Template Name                         : DirectoryEmailReplication
    Schema Version                        : 2
    Validity Period                       : 1 year
    Renewal Period                        : 6 weeks
    msPKI-Certificate-Name-Flag          : SUBJECT_ALT_REQUIRE_DIRECTORY_GUID, SUBJECT_ALT_REQUIRE_DNS
    mspki-enrollment-flag                 : INCLUDE_SYMMETRIC_ALGORITHMS, PUBLISH_TO_DS, AUTO_ENROLLMENT
    Authorized Signatures Required        : 0
    pkiextendedkeyusage                   : Directory Service Email Replication
    mspki-certificate-application-policy  : Directory Service Email Replication
    Permissions
      Enrollment Permissions
        Enrollment Rights           : NT AUTHORITY\ENTERPRISE DOMAIN CONTROLLERSS-1-5-9
                                      TECHCORP\Domain Admins        S-1-5-21-2781415573-3701854478-2406986946-512
                                      TECHCORP\Domain Controllers   S-1-5-21-2781415573-3701854478-2406986946-516
                                      TECHCORP\Enterprise Admins    S-1-5-21-2781415573-3701854478-2406986946-519
                                      TECHCORP\Enterprise Read-only Domain ControllersS-1-5-21-2781415573-3701854478-2406986946-498
      Object Control Permissions
        Owner                       : TECHCORP\Enterprise Admins    S-1-5-21-2781415573-3701854478-2406986946-519
        WriteOwner Principals       : TECHCORP\Domain Admins        S-1-5-21-2781415573-3701854478-2406986946-512
                                      TECHCORP\Enterprise Admins    S-1-5-21-2781415573-3701854478-2406986946-519
        WriteDacl Principals        : TECHCORP\Domain Admins        S-1-5-21-2781415573-3701854478-2406986946-512
                                      TECHCORP\Enterprise Admins    S-1-5-21-2781415573-3701854478-2406986946-519
        WriteProperty Principals    : TECHCORP\Domain Admins        S-1-5-21-2781415573-3701854478-2406986946-512
                                      TECHCORP\Enterprise Admins    S-1-5-21-2781415573-3701854478-2406986946-519

    CA Name                               : Techcorp-DC.techcorp.local\TECHCORP-DC-CA
    Template Name                         : KerberosAuthentication
    Schema Version                        : 2
    Validity Period                       : 1 year
    Renewal Period                        : 6 weeks
    msPKI-Certificate-Name-Flag          : SUBJECT_ALT_REQUIRE_DOMAIN_DNS, SUBJECT_ALT_REQUIRE_DNS
    mspki-enrollment-flag                 : AUTO_ENROLLMENT
    Authorized Signatures Required        : 0
    pkiextendedkeyusage                   : Client Authentication, KDC Authentication, Server Authentication, Smart Card Logon
    mspki-certificate-application-policy  : Client Authentication, KDC Authentication, Server Authentication, Smart Card Logon
    Permissions
      Enrollment Permissions
        Enrollment Rights           : NT AUTHORITY\ENTERPRISE DOMAIN CONTROLLERSS-1-5-9
                                      TECHCORP\Domain Admins        S-1-5-21-2781415573-3701854478-2406986946-512
                                      TECHCORP\Domain Controllers   S-1-5-21-2781415573-3701854478-2406986946-516
                                      TECHCORP\Enterprise Admins    S-1-5-21-2781415573-3701854478-2406986946-519
                                      TECHCORP\Enterprise Read-only Domain ControllersS-1-5-21-2781415573-3701854478-2406986946-498
      Object Control Permissions
        Owner                       : TECHCORP\Enterprise Admins    S-1-5-21-2781415573-3701854478-2406986946-519
        WriteOwner Principals       : TECHCORP\Domain Admins        S-1-5-21-2781415573-3701854478-2406986946-512
                                      TECHCORP\Enterprise Admins    S-1-5-21-2781415573-3701854478-2406986946-519
        WriteDacl Principals        : TECHCORP\Domain Admins        S-1-5-21-2781415573-3701854478-2406986946-512
                                      TECHCORP\Enterprise Admins    S-1-5-21-2781415573-3701854478-2406986946-519
        WriteProperty Principals    : TECHCORP\Domain Admins        S-1-5-21-2781415573-3701854478-2406986946-512
                                      TECHCORP\Enterprise Admins    S-1-5-21-2781415573-3701854478-2406986946-519

    CA Name                               : Techcorp-DC.techcorp.local\TECHCORP-DC-CA
    Template Name                         : WDAC
    Schema Version                        : 4
    Validity Period                       : 1 year
    Renewal Period                        : 6 weeks
    msPKI-Certificate-Name-Flag          : ENROLLEE_SUPPLIES_SUBJECT
    mspki-enrollment-flag                 : INCLUDE_BASIC_CONSTRAINTS_FOR_EE_CERTS
    Authorized Signatures Required        : 0
    pkiextendedkeyusage                   : Code Signing
    mspki-certificate-application-policy  : Code Signing
    Permissions
      Enrollment Permissions
        Enrollment Rights           : TECHCORP\Domain Admins        S-1-5-21-2781415573-3701854478-2406986946-512
                                      TECHCORP\Enterprise Admins    S-1-5-21-2781415573-3701854478-2406986946-519
      Object Control Permissions
        Owner                       : TECHCORP\Administrator        S-1-5-21-2781415573-3701854478-2406986946-500
        WriteOwner Principals       : TECHCORP\Administrator        S-1-5-21-2781415573-3701854478-2406986946-500
                                      TECHCORP\Domain Admins        S-1-5-21-2781415573-3701854478-2406986946-512
                                      TECHCORP\Enterprise Admins    S-1-5-21-2781415573-3701854478-2406986946-519
        WriteDacl Principals        : TECHCORP\Administrator        S-1-5-21-2781415573-3701854478-2406986946-500
                                      TECHCORP\Domain Admins        S-1-5-21-2781415573-3701854478-2406986946-512
                                      TECHCORP\Enterprise Admins    S-1-5-21-2781415573-3701854478-2406986946-519
        WriteProperty Principals    : TECHCORP\Administrator        S-1-5-21-2781415573-3701854478-2406986946-500
                                      TECHCORP\Domain Admins        S-1-5-21-2781415573-3701854478-2406986946-512
                                      TECHCORP\Enterprise Admins    S-1-5-21-2781415573-3701854478-2406986946-519

    CA Name                               : Techcorp-DC.techcorp.local\TECHCORP-DC-CA
    Template Name                         : Users
    Schema Version                        : 2
    Validity Period                       : 1 year
    Renewal Period                        : 6 weeks
    msPKI-Certificate-Name-Flag          : SUBJECT_ALT_REQUIRE_UPN, SUBJECT_ALT_REQUIRE_EMAIL, SUBJECT_REQUIRE_EMAIL, SUBJECT_REQUIRE_DIRECTORY_PATH
    mspki-enrollment-flag                 : INCLUDE_SYMMETRIC_ALGORITHMS, PUBLISH_TO_DS, AUTO_ENROLLMENT
    Authorized Signatures Required        : 0
    pkiextendedkeyusage                   : Client Authentication, Encrypting File System, Secure Email
    mspki-certificate-application-policy  : Client Authentication, Encrypting File System, Secure Email
    Permissions
      Enrollment Permissions
        Enrollment Rights           : NT AUTHORITY\Authenticated UsersS-1-5-11
                                      TECHCORP\Domain Admins        S-1-5-21-2781415573-3701854478-2406986946-512
                                      TECHCORP\Domain Users         S-1-5-21-2781415573-3701854478-2406986946-513
                                      TECHCORP\Enterprise Admins    S-1-5-21-2781415573-3701854478-2406986946-519
      Object Control Permissions
        Owner                       : TECHCORP\Administrator        S-1-5-21-2781415573-3701854478-2406986946-500
        WriteOwner Principals       : TECHCORP\Administrator        S-1-5-21-2781415573-3701854478-2406986946-500
                                      TECHCORP\Domain Admins        S-1-5-21-2781415573-3701854478-2406986946-512
                                      TECHCORP\Enterprise Admins    S-1-5-21-2781415573-3701854478-2406986946-519
        WriteDacl Principals        : TECHCORP\Administrator        S-1-5-21-2781415573-3701854478-2406986946-500
                                      TECHCORP\Domain Admins        S-1-5-21-2781415573-3701854478-2406986946-512
                                      TECHCORP\Enterprise Admins    S-1-5-21-2781415573-3701854478-2406986946-519
        WriteProperty Principals    : TECHCORP\Administrator        S-1-5-21-2781415573-3701854478-2406986946-500
                                      TECHCORP\Domain Admins        S-1-5-21-2781415573-3701854478-2406986946-512
                                      TECHCORP\Enterprise Admins    S-1-5-21-2781415573-3701854478-2406986946-519

    CA Name                               : Techcorp-DC.techcorp.local\TECHCORP-DC-CA
    Template Name                         : ForAdminsofPrivilegedAccessWorkstations
    Schema Version                        : 2
    Validity Period                       : 1 year
    Renewal Period                        : 6 weeks
    msPKI-Certificate-Name-Flag          : ENROLLEE_SUPPLIES_SUBJECT
    mspki-enrollment-flag                 : INCLUDE_SYMMETRIC_ALGORITHMS, PUBLISH_TO_DS
    Authorized Signatures Required        : 0
    pkiextendedkeyusage                   : Client Authentication, Encrypting File System, Secure Email
    mspki-certificate-application-policy  : Client Authentication, Encrypting File System, Secure Email
    Permissions
      Enrollment Permissions
        Enrollment Rights           : TECHCORP\Domain Admins        S-1-5-21-2781415573-3701854478-2406986946-512
                                      TECHCORP\Enterprise Admins    S-1-5-21-2781415573-3701854478-2406986946-519
                                      US\pawadmin                   S-1-5-21-210670787-2521448726-163245708-1138
      Object Control Permissions
        Owner                       : TECHCORP\Administrator        S-1-5-21-2781415573-3701854478-2406986946-500
        WriteOwner Principals       : TECHCORP\Administrator        S-1-5-21-2781415573-3701854478-2406986946-500
                                      TECHCORP\Domain Admins        S-1-5-21-2781415573-3701854478-2406986946-512
                                      TECHCORP\Enterprise Admins    S-1-5-21-2781415573-3701854478-2406986946-519
        WriteDacl Principals        : TECHCORP\Administrator        S-1-5-21-2781415573-3701854478-2406986946-500
                                      TECHCORP\Domain Admins        S-1-5-21-2781415573-3701854478-2406986946-512
                                      TECHCORP\Enterprise Admins    S-1-5-21-2781415573-3701854478-2406986946-519
        WriteProperty Principals    : TECHCORP\Administrator        S-1-5-21-2781415573-3701854478-2406986946-500
                                      TECHCORP\Domain Admins        S-1-5-21-2781415573-3701854478-2406986946-512
                                      TECHCORP\Enterprise Admins    S-1-5-21-2781415573-3701854478-2406986946-519



Certify completed in 00:00:06.9500485
PS C:\Auditor>
```